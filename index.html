<!DOCTYPE html>
<html class="dark">
<head>
  <meta charset="utf-8">
  <title>RAF Signature Events</title>
  <!-- Tailwind CSS via CDN for styling -->
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.3.0/dist/tailwind.min.css" rel="stylesheet">
  <!-- Supabase client -->
  <script src="https://unpkg.com/@supabase/supabase-js@2.39.3/dist/supabase.js"></script>
</head>
<body class="bg-white dark:bg-gray-900 text-gray-800 dark:text-gray-100">
  <nav class="flex justify-between items-center p-4">
    <img src="logo.png" alt="Logo" class="h-10">
    <button id="toggleTheme" class="px-4 py-2 bg-gray-200 dark:bg-gray-700 rounded">Toggle Theme</button>
  </nav>
  <section id="hero" class="p-8 text-center">
    <h1 class="text-4xl font-bold mb-4">Welcome to RAF Signature Events</h1>
    <p class="mb-6">Experience the glamour of celebrity masterclasses and more.</p>
    <a href="#events" class="px-6 py-3 bg-blue-600 text-white rounded">View Events</a>
  </section>
  <section id="events" class="p-8">
    <h2 class="text-3xl font-bold mb-4">Upcoming Events</h2>
    <div id="eventsList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
      <!-- events will be inserted here -->
    </div>
  </section>
  <section id="gallery" class="p-8">
    <h2 class="text-3xl font-bold mb-4">Gallery</h2>
    <div id="galleryList" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2">
      <!-- gallery images will be inserted here -->
    </div>
  </section>
  <script>
    // Replace these with your Supabase project URL and anon key
    const supabaseUrl = 'https://pojudmrkqruuxklwvkvj.supabase.co';
    const supabaseAnonKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBvanVkbXJrcXJ1dXhrbHd2a3ZqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYxMTE3ODgsImV4cCI6MjA3MTY4Nzc4OH0.dAwlj7yQm1eMz4weKroUC2t5Y_1N5koEHSpqqoH65G0';
    const supabase = supabase.createClient(supabaseUrl, supabaseAnonKey);

    // Theme toggle
    const toggleButton = document.getElementById('toggleTheme');
    toggleButton.addEventListener('click', () => {
      document.documentElement.classList.toggle('dark');
    });

    // Fetch published events and render them
    async function fetchEvents() {
      const { data, error } = await supabase
        .from('events')
        .select('*')
        .eq('is_published', true)
        .order('start_date', { ascending: true });
      if (error) {
        console.error('Error fetching events:', error);
        return;
      }
      const container = document.getElementById('eventsList');
      container.innerHTML = '';
      data.forEach(event => {
        const card = document.createElement('div');
        card.className = 'bg-white dark:bg-gray-800 shadow rounded p-4';
        card.innerHTML = `
          <h3 class="text-xl font-bold mb-2">${event.title}</h3>
          <p class="mb-2">${event.city || ''} ${event.city && event.venue ? 'â€“' : ''} ${event.venue || ''}</p>
          <p class="mb-4">${event.start_date ? new Date(event.start_date).toLocaleDateString() : ''}</p>
          <a href="#" class="text-blue-600 hover:underline">Register</a>
        `;
        container.appendChild(card);
      });
    }

    // Fetch gallery images and render them
    async function fetchGallery() {
      const { data, error } = await supabase
        .from('gallery')
        .select('*')
        .order('created_at', { ascending: false });
      if (error) {
        console.error('Error fetching gallery:', error);
        return;
      }
      const container = document.getElementById('galleryList');
      container.innerHTML = '';
      data.forEach(item => {
        const img = document.createElement('img');
        img.className = 'w-full h-40 object-cover rounded';
        img.src = item.image_url;
        img.alt = item.caption || '';
        container.appendChild(img);
      });
    }

    // Initialize page data
    fetchEvents();
    fetchGallery();
  </script>
</body>
</html>